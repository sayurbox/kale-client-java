plugins {
    id 'java'
    id 'eclipse'
    id "org.sonarqube" version "3.3"
}

group 'com.sayurbox.kale'
version '1.0.0'

apply plugin: 'jacoco'

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

repositories {
    mavenCentral()
}

def mainClassName = "com.sayurbox.kale.featureflag.FeatureFlagClientImpl"

jar {
    manifest {
        attributes "Main-Class": "$mainClassName"
    }
    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

dependencies {
    implementation "com.netflix.hystrix:hystrix-core:1.5.18"
    implementation "org.slf4j:slf4j-api:1.7.25"
    implementation "com.squareup.okhttp3:okhttp:3.14.6"
    implementation "com.google.code.gson:gson:2.8.5"
    implementation "org.slf4j:slf4j-api:1.7.32"

    implementation group: 'com.squareup.retrofit2', name: 'retrofit', version: '2.4.0'
    implementation "com.squareup.retrofit2:converter-gson:2.4.0"

    implementation "io.github.resilience4j:resilience4j-circuitbreaker:1.7.1"
    implementation "io.github.resilience4j:resilience4j-ratelimiter:1.7.1"
    implementation "io.github.resilience4j:resilience4j-retry:1.7.1"
    implementation "io.github.resilience4j:resilience4j-bulkhead:1.7.1"
    implementation "io.github.resilience4j:resilience4j-cache:1.7.1"
    implementation "io.github.resilience4j:resilience4j-timelimiter:1.7.1"
    implementation "io.github.resilience4j:resilience4j-retrofit:1.7.1"
    implementation "io.github.resilience4j:resilience4j-all:1.7.1"

    testImplementation "junit:junit:4.12"
    testImplementation "org.mockito:mockito-core:2.28.2"
    testImplementation "com.github.tomakehurst:wiremock-jre8:2.27.2"
}

sonarqube {
    properties {
        property "sonar.projectKey", "sayurbox_kale-client-java"
        property "sonar.organization", "sayurbox"
        property "sonar.host.url", "https://sonarcloud.io"
    }
}

jacocoTestReport {
    reports {
        xml.enabled true
    }
}
